# Docker Compose Override for CPU-only (No GPU required)
# =============================================================================
# Use this file if you don't have NVIDIA GPU or for CI/CD testing
# Usage: docker-compose -f docker-compose.yml -f docker-compose.cpu.yml up

services:
  # Ollama without GPU
  ollama:
    image: ollama/ollama:latest
    environment:
      - OLLAMA_NUM_PARALLEL=2
      - OLLAMA_MAX_LOADED_MODELS=1
    deploy:
      resources:
        limits:
          cpus: '4'
          memory: 8G

  # vLLM without GPU (use CPU fallback)
  vllm:
    image: vllm/vllm-openai:latest
    environment:
      - MODEL_NAME=facebook/opt-125m
      - MAX_MODEL_LEN=2048
      - DEVICE=cpu
    deploy:
      resources:
        limits:
          cpus: '2'
          memory: 4G

  # AIVO Brain without GPU
  aivo-brain:
    environment:
      - DEVICE=cpu
      - USE_4BIT_QUANTIZATION=false
    deploy:
      resources:
        limits:
          cpus: '2'
          memory: 8G

  # Model Cloning without GPU
  model-cloning:
    deploy:
      resources:
        limits:
          cpus: '2'
          memory: 4G
