# ============================================
# API Gateway Environment Configuration
# ============================================

# Application
APP_NAME=AIVO API Gateway
APP_VERSION=1.0.0
ENVIRONMENT=development
DEBUG=true
LOG_LEVEL=INFO

# Server
HOST=0.0.0.0
PORT=8001
WORKERS=4

# Database
DATABASE_URL=postgresql+asyncpg://aivo:aivo_secure_password@localhost:5432/aivo_auth
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30
DB_ECHO=false

# Redis Cache
REDIS_URL=redis://localhost:6379/0
REDIS_PASSWORD=
REDIS_MAX_CONNECTIONS=50
CACHE_TTL=3600

# JWT Configuration
JWT_SECRET_KEY=your-super-secret-jwt-key-change-this-in-production-min-32-chars
JWT_ALGORITHM=RS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=15
JWT_REFRESH_TOKEN_EXPIRE_DAYS=30
JWT_PRIVATE_KEY_PATH=/app/keys/jwt_private.pem
JWT_PUBLIC_KEY_PATH=/app/keys/jwt_public.pem

# Password Security (Argon2id)
PASSWORD_MIN_LENGTH=12
PASSWORD_TIME_COST=2
PASSWORD_MEMORY_COST=65536
PASSWORD_PARALLELISM=4
PASSWORD_HASH_LENGTH=32
PASSWORD_SALT_LENGTH=16

# Email Service (SendGrid)
SENDGRID_API_KEY=your-sendgrid-api-key
FROM_EMAIL=noreply@aivolearning.com
FROM_NAME=AIVO Learning
EMAIL_VERIFICATION_EXPIRE_HOURS=24
PASSWORD_RESET_EXPIRE_HOURS=1

# SMS Service (Twilio)
TWILIO_ACCOUNT_SID=your-twilio-account-sid
TWILIO_AUTH_TOKEN=your-twilio-auth-token
TWILIO_FROM_PHONE=+1234567890
SMS_VERIFICATION_EXPIRE_MINUTES=5

# MFA Configuration
MFA_ISSUER=AIVO Learning
MFA_BACKUP_CODES_COUNT=10
MFA_TOTP_DIGITS=6
MFA_TOTP_INTERVAL=30

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_LOGIN=10/minute
RATE_LIMIT_SIGNUP=5/hour
RATE_LIMIT_API=1000/hour
RATE_LIMIT_STORAGE_URL=redis://localhost:6379/1

# CORS
CORS_ORIGINS=http://localhost:5173,http://localhost:5174,http://localhost:5175,http://localhost:5176
CORS_CREDENTIALS=true
CORS_METHODS=GET,POST,PUT,DELETE,PATCH
CORS_HEADERS=*

# Session Management
SESSION_TIMEOUT_MINUTES=30
SESSION_EXTEND_ON_ACTIVITY=true
MAX_SESSIONS_PER_USER=5

# Security Headers
HSTS_MAX_AGE=31536000
CSP_DEFAULT_SRC=self
X_FRAME_OPTIONS=DENY
X_CONTENT_TYPE_OPTIONS=nosniff

# Risk-Based Authentication
RISK_SCORE_THRESHOLD=0.7
DEVICE_FINGERPRINT_ENABLED=true
GEOLOCATION_ENABLED=true
IMPOSSIBLE_TRAVEL_THRESHOLD_KM=500
MAXMIND_LICENSE_KEY=your-maxmind-license-key
MAXMIND_DB_PATH=/app/data/GeoLite2-City.mmdb

# COPPA Compliance
COPPA_AGE_THRESHOLD=13
PARENTAL_CONSENT_REQUIRED=true
PARENTAL_VERIFICATION_METHODS=credit_card,government_id

# SSO Configuration
# SAML
SAML_ENABLED=false
SAML_SP_ENTITY_ID=https://api.aivolearning.com
SAML_SP_ACS_URL=https://api.aivolearning.com/v1/auth/saml/acs
SAML_SP_CERT_PATH=/app/keys/saml_sp.crt
SAML_SP_KEY_PATH=/app/keys/saml_sp.key

# OAuth 2.0 / OIDC
OAUTH_GOOGLE_ENABLED=false
OAUTH_GOOGLE_CLIENT_ID=
OAUTH_GOOGLE_CLIENT_SECRET=
OAUTH_GOOGLE_REDIRECT_URI=https://api.aivolearning.com/v1/auth/oauth/google/callback

OAUTH_MICROSOFT_ENABLED=false
OAUTH_MICROSOFT_CLIENT_ID=
OAUTH_MICROSOFT_CLIENT_SECRET=
OAUTH_MICROSOFT_REDIRECT_URI=https://api.aivolearning.com/v1/auth/oauth/microsoft/callback

# Monitoring
SENTRY_DSN=
SENTRY_ENVIRONMENT=development
SENTRY_TRACES_SAMPLE_RATE=0.1
PROMETHEUS_ENABLED=true

# External Services
HIBP_API_KEY=your-haveibeenpwned-api-key
HIBP_API_URL=https://api.pwnedpasswords.com/range

# Feature Flags
FEATURE_MFA_REQUIRED=false
FEATURE_RISK_BASED_AUTH=true
FEATURE_SSO_ENABLED=false
FEATURE_COPPA_STRICT_MODE=true

# Audit Logging
AUDIT_LOG_RETENTION_DAYS=730
AUDIT_LOG_SENSITIVE_FIELDS=password,token,secret
